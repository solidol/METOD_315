\chapter{Структура web-додатків}

\section*{Анотація} 
Програми, що виконуються на клієнт-машині. Програми, що виконуються на сервері. Насичені інтернет-додатки. Введення в Jscript: типи даних, оператори, функції та об'єкти. Коротка характеристика VBScript. Java-аплети. ActionScript - загальна характеристика. XAML і Microsoft Silverlight. Поняття про DOM. DHTML. Регулярні вирази.

\section*{План лекції}
\begin{enumerate}
\item Програми, що виконуються на сервері
\item Програми, що виконуються на клієнті
\item Мови сценаріїв сумісні з ECMA
\item Java-аплети
\item XAML і Microsoft Silverlight
\end{enumerate}

\section{Програми, що виконуються на сервері}

Код програми, що працює на сервері, не передається клієнту. При отриманні від клієнта спеціального запиту, який передбачає виконання такої програми, сервер запускає її і передає параметри, що входять до складу запиту. Засоби для генерації подібного запиту зазвичай входять до складу HTML-документа.

Результати своєї роботи програма оформляє у вигляді HTML-документа і передає їх веб-сервера, а останній, в свою чергу, доповнює отримані дані HTTP-заголовком і передає їх клієнту.

\section{Програми, що виконуються на клієнті}

Одним з типів програм, призначених для виконання на клієнт-машині, є сценарії, наприклад, JavaScript (VBScript). Оригінальний текст сценарію є частиною веб-сторінки, тому сценарій JavaScript передається клієнту разом з документом, до складу якого він входить. обробляючи HTML-документ, браузер виявляє вихідний текст сценарію і запускає його на виконання.

До всіх програм, які передаються з сервера на клієнт-машини і запускаються на виконання, пред'являється одна загальна вимога: ці програми повинні бути позбавлені можливості звертатися до ресурсів комп'ютера, на якому вони виконуються. Така вимога цілком обґрунтована. Адже передача по мережі і запуск Java-апплетів і JavaScript-сценаріїв відбувається автоматично без участі користувача, тому робота цих програм повинна бути абсолютно безпечною для комп'ютера. Іншими словами, мови, призначені для створення програм, що виконуються на клієнт-машині, повинні бути абсолютно непридатні для написання вірусів і подібних програм. 

Насичений інтернет-додаток (Rich Internet application) - ще один підхід, який полягає у використанні Adobe Flash або Java-аплетів для повної або часткової реалізації призначеного для користувача інтерфейсу, оскільки більшість браузерів підтримує ці технології (як правило, за допомогою плагінів).

При використанні Java-апплетів до складу HTML-документа включається спеціальний дескриптор, що описує розташування файлу, що містить код аплету, на сервері. Після того як клієнт отримує HTML-код документа, що включає аплет, він генерує додатковий запит серверу. Після того як сервер пересилає клієнту код аплету, сам аплет запускається на виконання.

При використанні насичених інтернет-додатків доводиться стикатися з такими проблемами:
\begin{itemize}
\item необхідність забезпечення безпечного середовища виконання ( "пісочниця");
\item для виконання коду має бути дозволено виконання сценаріїв;
\item втрата в продуктивності (тому що Виконуємо на клієнтській стороні);
\item потрібно багато часу на завантаження; 
\end{itemize}
Для розробки насичених інтернет-додатків використовуються пакети Curl, Adobe Flex і Microsoft Silverlight. 

\section{Мови сценаріїв сумісні з ECMA}

JavaScript - інтерпретована мова програмування, стандартизований міжнародною організацією ECMA в специфікації ECMA-262. Мови JavaScript, JScript і ActionScript є розширенням стандарту ECMA-262.

Назва "ECMAScript" стало фактично компромісом між організаціями, залученими в процес стандартизації, зокрема Netscape і Microsoft. Хоча JavaScript і JScript прагнули до сумісності з ECMAScript, вони мають ряд додаткових можливостей не передбачених специфікацією ECMA.

Синтаксис JScript багато в чому аналогічний мови JavaScript, проте, крім додавання клієнтських скриптів на веб-сторінки і деяких інших функцій, JScript може використовуватися і для інших цілей, наприклад:

\begin{itemize}
\item автоматизація адміністрування систем Microsoft Windows;
\item створення сторінок ASP. 
\end{itemize}
Мова JScript отримала подальший розвиток у вигляді мови JScript.NET, яка орієнтована на роботу в рамках платформи Microsoft.NET

JScript - інтерпретована, об'єктно-орієнтована мова. Хоча він має істотно меншу кількість можливостей, ніж такі об'єктно-орієнтовані мови як C ++ та Java.

Можливості мови істотно обмежені:
\begin{itemize}
\item мова не дозволяє розробляти окремі програми;
\item сценарії на JScript можуть виконуватися тільки за допомогою інтерпретатора, зокрема веб-браузером.
\item JScript - мова без суворого контролю типів. Тому не потрібно оголошувати тип змінних явно. 
\end{itemize}    
    Крім того, у багатьох випадках JScript виконує перетворення автоматично, коли вони необхідні. Наприклад, при складання рядки і числа, число буде перетворено в рядок. 

Код на JScript пишеться в текстовому форматі, і організований в інструкції, блоки, що складаються з пов'язаних наборів інструкцій, і коментарів. 

ActionScript - об'єктно-орієнтована мова програмування, один з діалектів EcmaScript, який додає інтерактивність, обробку даних і багато іншого в вміст Flash-додатків. ActionScript виповнюється віртуальною машиною (ActionScript Virtual Machine), яка є складовою частиною програми Flash Player. ActionScript компілюється в байткод, який включається в SWF - файл.

SWF-файли виконуються Flash Player. Сам Flash Player існує у вигляді плагіна до веб-браузеру, а також як самостійне який виконувався додаток. У другому випадку можливе створення виконуваних exe-файлів, коли swf - файл включається у Flash Player. 


\section{Java-аплети}

Java - аплет - це програма, написана на мові Java і відкомпілювати в байт-код. Виполнет в браузері з використанням віртуальної Java-машини (JVM). Аплети використовуються для надання інтерактивних можливостей веб-додатків, які неможливі в HTML. Так як байт-код Java від платформи незалежний, то Java -апплети можуть виконуватися браузерами на багатьох операційних платформах.

Java - сервлети є серверними додатками, але вони відрізняються від аплетів мовою, функціями та іншими характеристиками.

призначені Java -апплети для виконання в безпечному середовищі з метою запобігання їх доступу до локальних ресурсів комп'ютера клієнта.

Код аплету завантажується з веб-сервера, і браузер

    або вставляє аплет в веб-сторінку;
    або відкриває окреме вікно з власним призначеним для користувача інтерфейсом аплету. 

Аплет може бути впроваджений в веб-сторінку за допомогою використання HTML тега <applet>, або (що рекомендується) тега <object>.

Можна назвати наступні переваги Java-апплетов:
\begin{itemize}
\item працюють практично на більшості операційних платформ;
\item підтримуються більшістю браузерів;
\item кешуються в більшості браузерів, що істотно прискорює їх завантаження при поверненні на веб-сторінку;
\item після першого запуску аплета, коли Java-машина вже виконується і швидко запускається, виконання аплетів відбувається значно швидше;
\item завантажуються зі швидкістю, порівнянної з програмами на інших компільованих мовах, наприклад C ++, але у багато разів швидше ніж на JavaScript. 
\end{itemize}
При цьому у Java -апплетов є і недоліки:
\begin{itemize}
\item потрібна установка Java-розширення, які доступні за замовчуванням не у всіх браузерах;
\item проблеми реалізації Java-розширень для 64-розрядних процесорів;
\item не можуть запускатися до першого завантаження віртуальної Java-машини, що може займати значний час;
\item розробка користувальницького інтерфейсу з використанням аплетів є більш складним завданням в порівнянні з HTML;
\item не мають прямого доступу до локальних ресурсів комп'ютера клієнта;
\item деякі аплети прив'язані до використання певного середовища часу виконання Java (JRE). 
\end{itemize}

\section{XAML і Microsoft Silverlight}

XAML (eXtensible Application Markup Language) - мова інтерфейсів платформи Windows Vista.

Модель додатків Vista включає об'єкт Application. Його набір властивостей, методів і подій дозволяє об'єднувати веб-документи в пов'язане додаток. Об'єкт Application контролює виконання програми та генерує події для призначеного для користувача коду. Документи додатки створюються за допомогою мови XAML, який описує, перш за все, призначений для користувача інтерфейс. Логіка додатка управляється процедурних кодом (С\#, VB і ін.). XAML включає основні чотири категорії елементів: панелі, елементи управління, елементи, пов'язані з документом і графічні фігури.

Microsoft Silverlight є офіційною назвою заснованої на XML і. NET технології під кодовим ім'ям WPF / E ( Windows Presentation Foundation Everywhere), що є альтернативною Adobe Flash. Являє собою підмножина Windows Presentation Foundation, в якому реалізовані векторна графіка, анімація і засоби відтворення відео. У версії 1.1 включає в себе повну версію .NET CLR - звану CoreCLR, що дозволить розробляти Silverlight додатки на будь-якому з мов. NET. Silverlight v.1.0 містить підключається модуль браузера для обробки XAML і кодеки для відтворення мультимедійного вмісту в форматах WMV, WMA і MP3.

Microsoft Silverlight являє браузеру внутрішню модель DOM, керовану з JavaScript коду. оскільки мова XAML заснований на XML, то документ, що визначає завантаження клієнта призначений для користувача інтерфейс - текстовий і тому цілком придатний для індексування пошуковими системами. Використовуючи модель DOM, JavaScript може динамічно оновлювати вміст Silverlight, аналогічно DHTML.

Також можна викликати методи управління презентацією (запуску анімації або призупинити відтворення відео, наприклад).

Silverlight - додаток починається з виклику об'єкта Silverlight з HTML сторінки, що завантажує XAML файл. XAML файл містить об'єкт Canvas, який виступає підкладкою для інших елементів. Об'єкти XAML здатні генерувати події, перехоплює з JavaScript. 

