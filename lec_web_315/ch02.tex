\chapter{Введення в клієнт-серверні технології Веб. протокол HTTP}

\section*{Анотація} 
Протокол HTTP. Схема HTTP-сеансу. Склад HTTP-запиту. Забезпечення безпеки передачі даних HTTP. Cookie.

\section*{План лекції}
\begin{enumerate}
\item Протокол HTTP
\item HTTP-запит
\item Відповідь сервера
\item Ідентифікація ресурсу
\end{enumerate}

\section{Протокол HTTP}

HTTP (HyperText Transfer Protocol - RFC 1945 року, RFC 2616) - протокол прикладного рівня для передачі гіпертексту.

Центральним об'єктом в HTTP є ресурс, на який вказує URL в запиті клієнта. Зазвичай такими ресурсами є що зберігаються на сервері файли. На відміну від багатьох інших протоколів, HTTP є протоколом без пам'яті. Це означає, що протокол не зберігає інформацію про попередні запити клієнтів і відповідях сервера. 

Усе програмне забезпечення для роботи з протоколом HTTP поділяється на три основні категорії:
\begin{enumerate}
\item Сервери - постачальники послуг зберігання та обробки інформації (обробка запитів).
\item Клієнти - кінцеві споживачі послуг сервера (відправка запитів).
\item Проксі-сервери для підтримки роботи транспортних служб.	
\end{enumerate}
 
"Класична" схема HTTP-сеанса виглядає так.

	\begin{enumerate}
\item Встановлення TCP-з'єднання.
\item Запит клієнта.
\item Відповідь сервера.
\item Розрив TCP-з'єднання.
	\end{enumerate} 

Таким чином, клієнт посилає серверу запит, отримує від нього відповідь, після чого взаємодія припиняється. зазвичай запит клієнта є вимога передати HTML-документ або який-небудь інший ресурс, а відповідь сервера містить код цього ресурсу.

\section{HTTP-запит}

До складу HTTP-запиту, переданого клієнтом серверу, входять наступні компоненти.
	\begin{enumerate}
\item Рядок стану (іноді для її позначення використовують також терміни рядок-статус, або рядок запиту).
\item Поля заголовка.
\item Порожня стрічка.
\item Тіло запиту. 
	\end{enumerate} 
	
	
Рядок стану має такий вигляд:

  метод\_запроса URL\_pecypca версія\_протокола\_НТТР 

Розглянемо компоненти рядка стану, при цьому особливу увагу приділимо методам запиту.

Метод, вказаний в рядку стану, визначає спосіб впливу на ресурс, URL якого заданий в тому ж рядку. Метод може приймати значення GET, POST, HEAD, PUT, DELETE і т.д. Незважаючи на велику кількість методів, для веб-програміста по-справжньому важливі лише два з них: GET і POST.

    GET. Згідно формального визначення, метод GET призначається для отримання ресурсу з зазначеним URL. Отримавши запит GET, сервер повинен прочитати зазначений ресурс і включити код ресурсу до складу відповіді клієнту. URL ресурсу може вказувати на виконуваний код програми, який, при дотриманні певних умов, повинен бути запущений на сервері. У цьому випадку клієнтові повертається не код програми, а дані, згенеровані в процесі її виконання. 
    
    POST. Згідно з тим же формального визначення, основне призначення методу POST - передача даних на сервер. Як і у випадку з методом GET, URL, заданий в рядку стану, вказує на конкретний ресурс. 
    
    Методи HEAD і PUT є модифікаціями методів GET і POST. 

Версія протоколу HTTP, як правило, задається в наступному форматі:

  HTTP/версія.модіфікація 	
	
Поля заголовка, наступні за рядком стану, дозволяють уточнювати запит, тобто передавати серверу додаткову інформацію. Поле заголовка має такий вигляд:

  Ім'я\_поля: Значення 

Призначення поля визначається його ім'ям, яке відокремлюється від значення двокрапкою.  У багатьох випадках при роботі в Веб тіло запиту відсутня. При запуску CGI-сценаріїв дані, що передаються для них в запиті, можуть розміщуватися в тілі запиту.

Нижче представлений приклад HTML-запит, згенерованого браузером

\begin{verbatim}
 GET http://oak.oakland.edu/ HTTP / 1.0
 Connection: Keep-Alive
 User-Agent: Mozilla / 4.04 [en] (Win95; I)
 Host: oak.oakland.edu
 Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, image/png, */*
 Accept-Language: en
 Accept-Charset: iso-8859-l, *, utf-8 
\end{verbatim}

Отримавши від клієнта запит, сервер повинен відповісти йому. Подібно запитом клієнта, відповідь сервера також складається з чотирьох перерахованих нижче компонентів.
\begin{enumerate}
\item Рядок стану.
\item Поля заголовка.
\item Порожня стрічка.
\item Тіло відповіді. 
\end{enumerate}
\section{Відповідь сервера}

Відповідь сервера клієнту починається з рядка стану, яка має такий вигляд:

  Версія\_протокола Код\_ответа Пояснітельное\_сообщеніе 

    Версія\_протокола задається в тому ж форматі, що і в запиті клієнта, і має таке ж значення.
    
    Код\_ответа - це тризначне десяткове число, яке представляє в закодованому вигляді результат обслуговування запиту сервером.
    
    Пояснітельное\_сообщеніе дублює код відповіді в символьному вигляді. Це рядок символів, яка не обробляється клієнтом. Вона призначена для системного адміністратора або оператора, що займається обслуговуванням системи, і є розшифровкою коду відповіді. 

З трьох цифр, складових код відповіді, перша (старша) визначає клас відповіді, інші дві представляють собою номер відповіді всередині класу. Так, наприклад, якщо запит був оброблений успішно, клієнт отримує наступне повідомлення:

  HТТР/1.0 200 ОК 

Перша цифра не може бути більше 5 і визначає наступні класи відповідей.

    1 - спеціальний клас повідомлень, які називаються інформаційними. Код відповіді, що починається з 1, означає, що сервер продовжує обробку запиту. При обміні даними між HTTP-клієнтом і HTTP-сервером повідомлення цього класу використовуються досить рідко.
    
    2 - успішна обробка запиту клієнта.
    
    3 - перенаправлення запиту. Щоб запит був обслужений, необхідно вжити додаткових заходів.
    
    4 - помилка клієнта. Як правило, код відповіді, що починається з цифри 4, повертається в тому випадку, якщо в запиті клієнта зустрілася синтаксична помилка.
    
    5 - помилка сервера. З тих чи інших причин сервер не в змозі виконати запит. 

Нижче представлений приклад відповіді сервера на запит, наведений в попередньому розділі. У тілі відповіді міститься вихідний текст HTML-документа.

\begin{verbatim}
 HTTP / 1.1 200 OK
 Server: Microsoft-IIS / 5.1
 X-Powered-By: ASP.NET
 Date: Mon, 20 OCT 2008 11:25:56 GMT
 Content-Type: text / html
 Accept-Ranges: bytes
 Last-Modified: Sat, 18 Oct 2008 15:05:44 GMT
 ETag: "b66a667f948c92: 8a5"
 Content-Length: 426

 <Html>
 <Body>
 <!-- Тіло HTML -->
 .........
 </ Body>
 </ Html> 
\end{verbatim}

Поля заголовка і тіло повідомлення можуть бути відсутніми, але рядок стану є обов'язковим елементом, так як вказує на тип запиту/відповіді.

Поле з ім'ям Content-type може зустрічатися як в запиті клієнта, так і у відповіді сервера. Як значення цього поля вказується MIME-тип вмісту запиту або відповіді. MIME-тип також передається в поле заголовка Accept, присутнього в запиті.

Специфікація MIME ( Multipurpose Internet Mail Extension - багатоцільове поштове розширення Internet) спочатку була розроблена для того, щоб забезпечити передачу різних форматів даних в складі електронних листів. Однак застосування MIME не вичерпується електронною поштою. 

Відповідно до специфікації MIME, для опису формату даних використовуються тип і підтип. Тип визначає, до якого класу належить формат вмісту HTTP-запит або HTTP -Відповісти. Підтип уточнює формат. Тип і підтип відокремлюються одна від одної косою рискою:

  тип/підтип 

Оскільки в переважній більшості випадків у відповідь на запит клієнта сервер повертає вихідний текст HTML-документа, то в поле Content-type відповіді зазвичай міститься значення text/html. тут ідентифікатор text визначає тип, повідомляючи, що клієнту передається символьна інформація, а ідентифікатор html описує підтип, тобто вказує на те, що послідовність символів, що міститься в тілі відповіді, являє собою опис документа на мові HTML.

Перелік типів і підтипів MIME досить великий. У таблиці 2.4 наведені приклади MIME-типу, найбільш часто зустрічаються в заголовках HTML-запит і відповідей. 

\section{Ідентифікація ресурсу}

Для однозначної ідентифікації ресурсів в мережі Інтернет використовуються унікальні ідентифікатори URL.

Однаковий ідентифікатор ресурсу URI ( Uniform Resource Identifier) являє собою коротку послідовність символів, що ідентифікує абстрактний або фізичний ресурс. URI не вказує на те, як отримати ресурс, а тільки ідентифікує його. 

    URL (Uniform Resource Locator) - це URI, який, крім ідентифікації ресурсу, надає ще й інформацію про місцезнаходження цього ресурсу.
    
    URN (Uniform Resource Name) - це URI, який ідентифікує ресурс в певному просторі імен, але, на відміну від URL, URN не вказує на місцезнаходження цього ресурсу. 

URL має наступну структуру:
\begin{verbatim}
  <Схема>://<логін>:<пароль>@<хост>:<порт>/<URL-шлях> 
\end{verbatim}
де:

    схема - схема звернення до ресурсу (зазвичай мережевий протокол);
    логін - ім'я користувача, що використовується для доступу до ресурсу;
    пароль - пароль, асоційований з вказаним ім'ям користувача;
    хост - повністю прописане доменне ім'я хоста в системі DNS або IP-адреса хоста;
    порт - порт хоста для підключення;
    URL-шлях - уточнююча інформація про місце знаходження ресурсу. 

Загальноприйняті схеми (протоколи) URL включають протоколи: ftp, http, https, telnet, а також інші.



